<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>„ÅÇ„ÅÆÔΩûÂ∑Æ„ÅóÊîØ„Åà„Å™„Åë„Çå„Å∞„Éª„Éª„Éª</title>
    <link href="https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@700;800&family=Noto+Sans+JP:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; background-color: #f0f4f8; -webkit-tap-highlight-color: transparent; overflow: hidden; }
        .mincho { font-family: 'Shippori Mincho', serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .mesh-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: radial-gradient(at 0% 0%, #e0e7ff 0%, transparent 50%), radial-gradient(at 100% 100%, #e0f2fe 0%, transparent 50%); filter: blur(60px); opacity: 0.5; }
        .glass-card { background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(8px); border: 1px solid rgba(255, 255, 255, 0.4); box-shadow: 0 4px 15px -5px rgba(0, 0, 0, 0.05); }
        
        @keyframes confetti-fall { 0% { transform: translateY(-10vh) rotate(0deg); opacity: 1; } 100% { transform: translateY(110vh) rotate(720deg); opacity: 0; } }
        .confetti { position: fixed; width: 10px; height: 10px; z-index: 50; pointer-events: none; animation: confetti-fall 3s linear forwards; }
        @keyframes shine { 0% { filter: brightness(1) drop-shadow(0 0 5px rgba(255,255,255,0)); } 50% { filter: brightness(1.5) drop-shadow(0 0 20px gold); } 100% { filter: brightness(1) drop-shadow(0 0 5px rgba(255,255,255,0)); } }
        .champion-shine { animation: shine 2s infinite ease-in-out; }
        @keyframes halo { 0% { transform: scale(1); opacity: 0.3; } 50% { transform: scale(1.2); opacity: 0.6; } 100% { transform: scale(1); opacity: 0.3; } }
        .halo-effect { position: absolute; width: 200%; height: 200%; background: radial-gradient(circle, gold 0%, transparent 70%); z-index: -1; animation: halo 4s infinite ease-in-out; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- „Ç¢„Ç§„Ç≥„É≥„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà ---
        const IconGem = ({ color = "currentColor", size = 20, fill = "none", className="" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill={fill} stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M6 3h12l4 6-10 12L2 9z"/><path d="M11 3 8 9l3 12"/><path d="m13 3 3 6-3 12"/><path d="M2 9h20"/>
            </svg>
        );
        const IconCrown = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="gold" stroke="orange" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7z"/><path d="M12 17H12"/><path d="M5 20h14"/>
            </svg>
        );
        const IconPlay = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="m7 3 14 9-14 9V3z"/></svg>;
        const IconPlus = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>;
        const IconMinus = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round"><line x1="5" y1="12" x2="19" y2="12"/></svg>;
        const IconTrophy = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>;
        const IconZap = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>;
        const IconEye = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>;
        const IconHeart = () => <svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor" className="text-rose-500"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>;
        const IconStar = () => <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor" className="text-amber-300"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>;
        const IconHome = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>;
        const IconFlag = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/><line x1="4" y1="22" x2="4" y2="15"/></svg>;
        const IconUsers = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>;

        const PLAYER_CONFIG = [
            { id: 0, label: 'Á¥ÖÊ∞¥Êô∂', color: '#FF4D4D', bg: 'bg-red-500' },
            { id: 1, label: 'Áë†ÁíÉÁü≥', color: '#4D94FF', bg: 'bg-blue-500' },
            { id: 2, label: 'ÈáëÁ∑ëÁü≥', color: '#FFB84D', bg: 'bg-amber-500' },
            { id: 3, label: 'Áø°Áø†', color: '#10B981', bg: 'bg-emerald-500' },
            { id: 4, label: 'Á¥´Ê∞¥Êô∂', color: '#8B5CF6', bg: 'bg-purple-500' },
        ];
        const CPU_CONFIG = { id: 'cpu', label: 'ÈªíÈáëÂâõÁü≥(CPU)', bg: 'bg-gray-800' };

        const ODAI_LIST = [
            "ÈäÄË°å„ÅÆÁ™ìÂè£„Å´„Å¶„ÄÅÊãÖÂΩì„ÅÆË°åÂì°„Å∏", "Âæ©Ê¥ª„Åó„ÅüÈ≠îÁéã„Åå„ÄÅÂãáËÄÖ‰∏ÄË°å„Å∏", "ÁàÜÂºæËß£‰Ωì‰∏≠„ÄÅÈúá„Åà„ÇãÁõ∏Ê£í„Å∏",
            "„Éá„Éº„Éà„ÅÆÂà•„ÇåÈöõ„ÄÅ„Éë„Éº„Éà„Éä„Éº„Å∏", "ÊúÄÁµÇÈù¢Êé•„ÅÆÂ†¥„ÄÅÁ§æÈï∑„Å∏", "ÂÆáÂÆôËàπÂÜÖ„ÄÅÂú∞ÁêÉ‰∫∫„Å∏",
            "Êï£È´™‰∏≠„ÄÅÁæéÂÆπÂ∏´„Å∏", "Âà§Ê±∫Áõ¥Ââç„ÄÅË¢´Âëä‰∫∫„ÇíË¶ã„Å§„ÇÅ„ÇãË£ÅÂà§ÂÆò", "Ë™ì„ÅÑ„ÅÆ„Ç≠„Çπ„ÅÆÁõ¥Ââç„ÄÅÊñ∞Â©¶/Êñ∞ÈÉé„Å∏",
            "„Ç≥„É≥„Éì„Éã„É¨„Ç∏„ÄÅË¢ãË©∞„ÇÅ‰∏≠„ÅÆÂ∫óÂì°„Å∏", "Â¥ñ„Å£„Å∑„Å°„ÄÅËøΩ„ÅÑË©∞„ÇÅ„ÅüÁäØ‰∫∫„Å∏", "Âàù„ÇÅ„Å¶„ÅÆÊå®Êã∂„ÄÅÂΩºÂ•≥„ÅÆ‰∏°Ë¶™„Å∏",
            "ÊâãË°ìÂÆ§„ÄÅ„É°„Çπ„ÇíÊè°„ÇãÂ§ñÁßëÂåª„Å∏", "„ÅäÂåñ„ÅëÂ±ãÊï∑„ÄÅË•≤„ÅÑ„Åã„Åã„ÇãÂπΩÈúä„Å∏", "ÂèñË™øÂÆ§„ÄÅ„Ç´„ÉÑ‰∏º„ÇíÂá∫„ÅôÂàë‰∫ã„Å∏",
            "ÁÑ°ÈáçÂäõÁ©∫Èñì„ÄÅÊºÇ„ÅÜÂêåÂÉöÂ£´„Å∏", "„ÅäËèìÂ≠ê„ÅÆÂÆ∂„ÅÆÁéÑÈñ¢„ÄÅÈ≠îÂ•≥„Å´Âêë„Åã„Å£„Å¶", "ÊòüÂ±ë„ÇíÈá£„Çã„Éú„Éº„Éà„ÅÆ‰∏ä„Åß",
            "ËàûË∏è‰ºö„ÄÅÈ≠îÊ≥ï„ÅåËß£„Åë„ÇãÊ∑±Â§ú0ÊôÇ", "Âñã„Çã„Ç¶„Çµ„ÇÆ„ÅÆ„ÉÜ„Ç£„Éº„Éë„Éº„ÉÜ„Ç£„Éº„Åß",
            "Â∞ÅÂç∞„Åï„Çå„ÅóÂè≥ËÖï„ÅåÁñº„ÅèÊîæË™≤Âæå", "ÊºÜÈªí„ÅÆÁøº„ÇíÂ∫É„Åí„ÅüÂ†ïÂ§©‰Ωø„ÅÆÈôçËá®", "Áï∞Áïå„ÅÆÈñÄ„ÅåÈñã„Åì„ÅÜ„Å®„Åó„Å¶„ÅÑ„ÇãÂú∞‰∏ãÈÄöË∑Ø",
            "È≠îÁúº„ÅåÊö¥Ëµ∞„Åó„Åù„ÅÜ„Å™Âõ≥Êõ∏ÂÆ§„ÅÆÈöÖ", "ËÅñÊà¶„ÅÆÁÅ´Ëìã„ÅåÂàá„Çâ„Çå„ÅüÈõ®„ÅÆÂ±ã‰∏ä", "Ê£Æ„ÅÆÂ••„ÄÅÂ∑®Â§ß„Å™Âñã„Çã„Ç≠„Éé„Ç≥„ÇíÂâç„Å´",
            "„Ç∑„É•„Ç¨„Éº„Ç≠„É£„ÉÉ„Çπ„É´„ÅÆË°õÂÖµ„Å∏", "‰∏âÊó•Êúà„ÅÆ„Éñ„É©„É≥„Ç≥„Å´Êè∫„Çå„ÇãÂ¶ñÁ≤æ„Å∏", "Âë™„Çè„Çå„ÅüËÅñÂâ£„ÇíÂºï„ÅçÊäú„Åì„ÅÜ„Å®„Åô„ÇãÊôÇ",
            "ÊöóÈªíÁµÑÁπî„ÅÆÂππÈÉ®„ÅåÈõÜ„Åæ„ÇãÂÜÜÂçì‰ºöË≠∞"
        ];
        
        const KOTOBA_LIST = [
            "Èºª„ÅÆÁ©¥„Å´Â∞èÊåá„ÇíÁ™Å„Å£Ëæº„Åæ„Åõ„Å¶Ôºü", "‰ªäÁùÄ„Å¶„ÅÑ„ÇãÊúç„ÅÆ„Çø„Ç∞ÊíÆ„Çâ„Åõ„Å¶", "3ÂàÜÈñì„Å†„ÅëÊÅØ„Çí‰ª£„Çè„Å£„Å¶",
            "ÁßÅ„ÅÆ„Åì„Å®„Çí„Äå„Éû„Éû„Äç„Å®Âëº„Çì„Åß", "100ÂÜÜË≤∏„Åó„Å¶„Åù„ÅÆ„Åæ„ÅæÂøò„Çå„Å¶", "ÂÖ®Âäõ„ÅÆÂ§âÈ°î„ÇíÊä´Èú≤„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
            "Ë™ûÂ∞æ„Å´„Äå„Åß„Åî„Åñ„Çã„Äç„Çí„Å§„Åë„Å¶", "Èù¥„ÇíÂ∑¶Âè≥Â±•„ÅçÊõø„Åà„Å™„ÅÑÔºü", "Ê≠Ø„Å´„Éç„ÇÆ„Åå„Å§„ÅÑ„Å¶„Åæ„Åô„Çà„ÄÇ",
            "Á§æ‰ºö„ÅÆÁ™ì„ÅåÂÖ®Èñã„Åß„Åô„Çà„ÄÇ", "ÂÆü„ÅØÁßÅ„ÄÅ„ÅÇ„Å™„Åü„ÅÆ„Åì„Å®„ÅåÂ•Ω„Åç„Å™„Çì„Åß„Åô„ÄÇ", "„Å®„Çä„ÅÇ„Åà„Åö„ÄÅ„Éì„Éº„É´„Åß„ÅÑ„ÅÑÔºü",
            "ËÄ≥„Åü„Å∂„ÇíÂ∞ë„Åó„Å†„ÅëËß¶„Å£„Å¶„ÅÑ„ÅÑÔºü", "ÁúâÊØõ„ÇíÁπã„Åí„Å¶„ÇÇ„ÅÑ„ÅÑ„Åß„Åô„ÅãÔºü", "ÁÑ°Èü≥„Åß„ÉÄ„É≥„Çπ„ÇíË∏ä„Çä„Åæ„Åõ„Çì„ÅãÔºü",
            "Êàë„ÅåÈóá„ÅÆÂäõ„ÄÅËß£Êîæ„Åó„Å¶„ÅÑ„ÅÑÔºü", "Â•ëÁ¥Ñ„ÅÆË°Ä„Çí„ÄÅ„Åì„ÅÆËÅñÊùØ„Å´Ê≥®„ÅÑ„ÅßÔºü", "Ë≤¥Êßò„ÅÆÈ≠Ç„ÄÅÊµÑÂåñ„Åï„Åõ„Å¶Ôºü",
            "ÁµÇÁÑâ„ÅÆË™ø„Åπ„ÇíÂ•è„Åß„Åæ„Åõ„Çì„ÅãÔºü", "„Åì„ÅÆÁúº„Å´ÂÆø„ÇãÁãÇÊ∞ó„ÇíË¶ã„Å™„ÅÑ„ÅßÔºü", "Ê∑±Ê∑µ„Çà„Çä„ÄÅÈÄô„ÅÑÂá∫„Åó„Å¶Ôºü",
            "ÈÅãÂëΩ„ÅÆÊ≠ØËªä„Çí„ÄÅÈÄÜÂõûËª¢„Åï„Åõ„Å¶Ôºü", "ÈÇ™Áúº„ÅåÂÖ±È≥¥„Åó„Å¶„ÅÑ„Çã‚Ä¶Èõ¢„Çå„Å¶Ôºü", "È≠îÊ≥ï„ÅÆÁ≤â„Çí„ÄÅÊåØ„Çä„Åã„Åë„Å¶Ôºü",
            "„Ç¨„É©„Çπ„ÅÆÈù¥,Ë©¶ÁùÄ„Åï„Åõ„Å¶Ôºü", "„ÅäÁ©∫„ÅÆÈõ≤„Çí„ÄÅÂë≥Ë¶ã„Åó„Å¶„ÇÇ„ÅÑ„ÅÑÔºü", "Êòü„ÅÆ„Åó„Åö„Åè„Åß„ÅäËå∂Ê∑π„Çå„ÇãÔºü",
            "Â§¢„ÅÆ‰∏≠„Å´„ÄÅ„ÅäÈÇ™È≠î„Åó„Å¶„ÇÇÔºü", "Ëôπ„ÅÆÂΩºÊñπ„Åæ„Åß„ÄÅÈÄ£„Çå„Å¶„Å£„Å¶Ôºü", "„Ç≠„É£„É≥„Éá„Ç£„ÅÆÈ≠îÊ≥ï„ÄÅÂèó„Åë„Å¶Ôºü",
            "Âñã„Çã„ÉÜ„Ç£„Éº„Ç´„ÉÉ„Éó„ÄÅÂàÜ„Åë„Å¶Ôºü", "Ê£Æ„ÅÆÁ≤æÈúä„Å´„ÄÅÊå®Êã∂„Åó„Å¶Ôºü", "È≠îÂäõ„ÅåÂ∞Ω„Åç„Çã„Åæ„Åß„ÄÅÂÅ¥„Å´„ÅÑ„Å¶Ôºü",
            "„Åì„ÅÆ‰∏ñÁïå„Çí„ÄÅ„É™„Çª„ÉÉ„Éà„Åó„Å¶„ÅÑ„ÅÑÔºü", "Èóá„Å´È£≤„Åæ„Çå„ÇàÔºÅ‚Ä¶Â∑Æ„ÅóÊîØ„Åà„Å™„Åë„Çå„Å∞„ÄÇ"
        ];

        const Confetti = ({ color }) => {
            const pieces = useMemo(() => Array.from({ length: 40 }), []);
            return (
                <React.Fragment>
                    {pieces.map((_, i) => (
                        <div key={i} className="confetti" style={{
                            left: `${Math.random() * 100}vw`,
                            backgroundColor: i % 2 === 0 ? color : '#ffd700',
                            animationDelay: `${Math.random() * 2}s`,
                            width: `${5 + Math.random() * 8}px`,
                            height: `${5 + Math.random() * 8}px`,
                        }} />
                    ))}
                </React.Fragment>
            );
        };

        function App() {
            // ÂàùÊúüË®≠ÂÆö: 3‰∫∫„Éª1ÁÇπ
            const [gameState, setGameState] = useState('START');
            const [playerCount, setPlayerCount] = useState(3);
            const [pointGoal, setPointGoal] = useState(1); 
            const [scores, setScores] = useState({});
            const [oyaIndex, setOyaIndex] = useState(0);
            const [currentOdai, setCurrentOdai] = useState('');
            const [submissions, setSubmissions] = useState([]);
            const [currentPlayerInputIndex, setCurrentPlayerInputIndex] = useState(0);
            const [playerHands, setPlayerHands] = useState({});
            const [selectedWinner, setSelectedWinner] = useState(null);
            const [revealedIndices, setRevealedIndices] = useState([]);
            const [gameChampion, setGameChampion] = useState(null);

            const adjustGoal = (delta) => {
                if (pointGoal === '‚àû') { if (delta < 0) setPointGoal(10); } else {
                    const next = pointGoal + delta;
                    if (next > 10) setPointGoal('‚àû'); else if (next < 1) setPointGoal('‚àû'); else setPointGoal(next);
                }
            };

            const startGame = () => {
                const initialScores = {};
                for (let i = 0; i < playerCount; i++) initialScores[i] = 0;
                setScores(initialScores);
                setGameChampion(null);
                startRound(0, playerCount);
            };

            const startRound = (oyaIdx, count = playerCount) => {
                setOyaIndex(oyaIdx);
                setCurrentOdai(ODAI_LIST[Math.floor(Math.random() * ODAI_LIST.length)]);
                setSubmissions([]);
                setSelectedWinner(null);
                setRevealedIndices([]);
                const hands = {};
                for (let i = 0; i < count; i++) {
                    if (count === 2 || i !== oyaIdx) {
                        hands[i] = [...KOTOBA_LIST].sort(() => 0.5 - Math.random()).slice(0, 5);
                    }
                }
                setPlayerHands(hands);
                setCurrentPlayerInputIndex(count === 2 ? 0 : (oyaIdx + 1) % count);
                setGameState('ODAI_DRAW');
            };

            const submitCard = (pIdx, card) => {
                const newSub = [...submissions, { playerIdx: pIdx, card }];
                const required = playerCount === 2 ? 2 : playerCount - 1;
                if (newSub.length === required) {
                    setSubmissions([...newSub].sort(() => 0.5 - Math.random()));
                    setGameState('REVEAL');
                } else {
                    setSubmissions(newSub);
                    let next = (pIdx + 1) % playerCount;
                    if (playerCount > 2) {
                        let safety = 0;
                        while (next === oyaIndex && safety < 10) { next = (next + 1) % playerCount; safety++; }
                    }
                    setCurrentPlayerInputIndex(next);
                    setGameState('ODAI_DRAW');
                }
            };

            const selectWinner = (sub) => {
                setSelectedWinner(sub);
                const newScores = { ...scores };
                newScores[sub.playerIdx] += 1;
                setScores(newScores);
                if (pointGoal !== '‚àû' && newScores[sub.playerIdx] >= pointGoal) {
                    setGameChampion(PLAYER_CONFIG[sub.playerIdx]);
                }
                setGameState('WINNER');
            };

            return (
                <div className="min-h-screen flex flex-col items-center p-2 relative overflow-hidden text-slate-800">
                    <div className="mesh-bg" />
                    {gameChampion && <Confetti color={gameChampion.color} />}
                    
                    {gameState !== 'START' && (
                        <header className="w-full max-w-md py-1 flex justify-between items-center px-2 z-10 fade-in">
                            <h1 className="text-[8px] font-black text-indigo-950 uppercase opacity-20 tracking-tighter">Polite Absurdity</h1>
                            <div className={`flex items-center gap-1 text-[9px] font-bold ${playerCount === 2 ? CPU_CONFIG.bg : PLAYER_CONFIG[oyaIndex].bg} text-white px-2 py-0.5 rounded-full shadow-sm`}>
                                <IconGem size={10} color="white" fill="white" />
                                <span>Ë¶™: {playerCount === 2 ? "CPU" : PLAYER_CONFIG[oyaIndex].label}</span>
                            </div>
                        </header>
                    )}

                    <main className="w-full max-w-md flex-grow flex flex-col z-10 justify-center px-1">
                        
                        {/* 1. „Çπ„Çø„Éº„ÉàÁîªÈù¢ */}
                        {gameState === 'START' && (
                            <div className="flex flex-col gap-6 items-center fade-in">
                                <div className="text-center mincho -mt-24 mb-4 space-y-4">
                                    <h1 className="text-3xl sm:text-4xl font-black text-indigo-950 drop-shadow-sm tracking-tight leading-none">„ÅÇ„ÅÆÔΩû</h1>
                                    <h1 className="text-3xl sm:text-4xl font-black text-indigo-950 drop-shadow-sm tracking-tight leading-none">Â∑Æ„ÅóÊîØ„Åà„Å™„Åë„Çå„Å∞„Éª„Éª„Éª</h1>
                                </div>
                                <div className="glass-card w-full p-4 rounded-[2rem] space-y-3">
                                    <div className="grid grid-cols-2 gap-2">
                                        <div className="space-y-1 text-center">
                                            <h2 className="text-[8px] font-black text-slate-400 uppercase tracking-widest leading-none">‰∫∫Êï∞</h2>
                                            <div className="flex items-center justify-between bg-white/60 p-0.5 rounded-full border border-white">
                                                <button onClick={() => setPlayerCount(Math.max(2, playerCount - 1))} className="w-7 h-7 rounded-full bg-white shadow-sm flex items-center justify-center text-slate-400"><IconMinus /></button>
                                                <span className="text-xl font-black text-indigo-950">{playerCount}Âêç</span>
                                                <button onClick={() => setPlayerCount(Math.min(5, playerCount + 1))} className="w-7 h-7 rounded-full bg-white shadow-sm flex items-center justify-center text-indigo-500"><IconPlus /></button>
                                            </div>
                                        </div>
                                        <div className="space-y-1 text-center">
                                            <h2 className="text-[8px] font-black text-slate-400 uppercase tracking-widest leading-none">ÂãùÂà©ÁÇπ</h2>
                                            <div className="flex items-center justify-between bg-white/60 p-0.5 rounded-full border border-white">
                                                <button onClick={() => adjustGoal(-1)} className="w-7 h-7 rounded-full bg-white shadow-sm flex items-center justify-center text-slate-400"><IconMinus /></button>
                                                <span className="text-xl font-black text-indigo-950">{pointGoal}</span>
                                                <button onClick={() => adjustGoal(1)} className="w-7 h-7 rounded-full bg-white shadow-sm flex items-center justify-center text-indigo-500"><IconPlus /></button>
                                            </div>
                                        </div>
                                    </div>
                                    <button onClick={startGame} className="w-full py-3 bg-indigo-600 text-white text-base font-black rounded-full shadow-lg flex items-center justify-center gap-2 active:scale-95 transition-all">„Ç≤„Éº„É†ÈñãÂßã <IconPlay /></button>
                                </div>
                            </div>
                        )}

                        {/* 2. „Çπ„Éû„Éõ„ÇíÊ∏°„ÅôÁîªÈù¢ */}
                        {gameState === 'ODAI_DRAW' && (
                            <div className="space-y-6 py-1 flex flex-col items-center fade-in">
                                <h2 className="text-3xl sm:text-4xl mincho font-black text-indigo-950 text-center leading-tight px-2 underline underline-offset-8 decoration-indigo-300">„Äå{currentOdai}„Äç</h2>
                                <div className="w-full bg-indigo-950 text-white p-5 rounded-[2rem] shadow-xl text-center space-y-4">
                                    <div className="flex flex-col items-center gap-3">
                                        <div className={`w-14 h-14 ${PLAYER_CONFIG[currentPlayerInputIndex].bg} rounded-xl flex items-center justify-center shadow-lg border border-white/20 rotate-3`}>
                                            <IconGem size={32} color="white" fill="white" />
                                        </div>
                                        <p className="text-lg font-black" style={{ color: PLAYER_CONFIG[currentPlayerInputIndex].color }}>{PLAYER_CONFIG[currentPlayerInputIndex].label}</p>
                                        <p className="text-[10px] text-indigo-100 opacity-80 leading-relaxed px-4 text-center">„Çπ„Éû„Éõ„ÇíÊ∏°„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ<br/>ÂÜÖÁ∑í„ÅßÊâãÊú≠„ÇíÈÅ∏„Å≥„Åæ„Åô„ÄÇ</p>
                                    </div>
                                    <button onClick={() => setGameState('PLAYER_SELECT')} className="w-full py-3 bg-indigo-500 text-white font-black rounded-xl flex items-center justify-center gap-2 active:scale-95 transition-all">ÊâãÊú≠„ÇíÁ¢∫Ë™ç <IconEye /></button>
                                </div>
                            </div>
                        )}

                        {/* 3. ÊâãÊú≠ÈÅ∏ÊäûÁîªÈù¢ */}
                        {gameState === 'PLAYER_SELECT' && (
                            <div className="space-y-4 py-1 fade-in">
                                <div className="bg-white p-4 rounded-xl border-l-[6px] shadow-sm flex flex-col items-center justify-center" style={{ borderColor: PLAYER_CONFIG[currentPlayerInputIndex].color }}>
                                    <span className="text-[10px] font-black text-slate-300 uppercase mb-1">ÁèæÂú®„ÅÆ„Ç∑„ÉÅ„É•„Ç®„Éº„Ç∑„Éß„É≥</span>
                                    <p className="font-bold text-indigo-950 text-xl mincho text-center leading-tight italic">„Äå{currentOdai}„Äç</p>
                                </div>
                                <div className="grid gap-1.5 overflow-y-auto max-h-[50vh] pr-1 no-scrollbar pb-2">
                                    {playerHands[currentPlayerInputIndex]?.map((card, i) => (
                                        <button key={i} onClick={() => submitCard(currentPlayerInputIndex, card)} className="bg-white p-3 text-left rounded-lg border border-slate-100 shadow-sm font-bold flex items-center gap-2.5 active:bg-indigo-50 transition-all">
                                            <span className="text-[8px] font-black text-slate-200 flex-shrink-0">0{i+1}</span>
                                            <span className="text-sm leading-snug">{card}</span>
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* 4. ÂõûÁ≠îÁô∫Ë°®ÁîªÈù¢ */}
                        {gameState === 'REVEAL' && (
                            <div className="space-y-3 py-1 pb-14 fade-in overflow-y-auto max-h-[85vh] no-scrollbar">
                                <div className="p-4 rounded-xl shadow-sm text-center text-white bg-indigo-900 border border-white/20">
                                    <span className="text-[9px] font-black opacity-60 uppercase block mb-1">„ÅäÈ°å</span>
                                    <h3 className="text-xl font-black mincho leading-tight italic">„Äå{currentOdai}„Äç</h3>
                                </div>
                                {submissions.map((sub, i) => {
                                    const isRevealed = revealedIndices.includes(i);
                                    const pCfg = PLAYER_CONFIG[sub.playerIdx];
                                    return (
                                        <div key={i} className="space-y-1">
                                            <div onClick={() => setRevealedIndices(prev => prev.includes(i) ? prev.filter(x => x !== i) : [...prev, i])} 
                                                 className={`p-3 rounded-xl border-2 min-h-[60px] flex flex-col justify-center items-center shadow-sm transition-all duration-300 ${isRevealed ? 'bg-white border-indigo-400' : 'bg-slate-900 border-slate-800 text-white'}`}>
                                                {isRevealed ? (
                                                    <div className="text-center space-y-0.5 text-slate-800">
                                                        <p className="text-indigo-600 font-bold text-[9px] italic leading-none">„ÅÇ„ÅÆ„Éº„ÄÅÂ∑Æ„ÅóÊîØ„Åà„Å™„Åë„Çå„Å∞„ÄÅ</p>
                                                        <p className="text-base font-black text-indigo-950 leading-tight">„Äå{sub.card}„Äç</p>
                                                    </div>
                                                ) : (
                                                    <div className="flex flex-col items-center gap-1 opacity-50"><IconEye size={14} /><p className="font-black text-[7px] uppercase tracking-widest leading-none">ÂõûÁ≠î #{i+1} „ÇíË¶ã„Çã</p></div>
                                                )}
                                            </div>
                                            {isRevealed && (
                                                <button onClick={() => selectWinner(sub)} 
                                                        className={`w-full py-2.5 rounded-lg text-white font-black text-[11px] flex items-center justify-center gap-1.5 ${pCfg.bg} shadow active:scale-95 transition-all`}>
                                                    <IconTrophy size={12} /> {pCfg.label}
                                                </button>
                                            )}
                                        </div>
                                    );
                                })}
                            </div>
                        )}

                        {/* 5. ÂãùÂà©„ÉªÂÑ™ÂãùÁîªÈù¢ */}
                        {gameState === 'WINNER' && (
                            <div className="flex flex-col items-center gap-3 py-1 fade-in text-center relative">
                                {gameChampion && <div className="halo-effect" />}
                                <div className="space-y-1">
                                    <div className={`w-14 h-14 ${gameChampion ? gameChampion.bg : PLAYER_CONFIG[selectedWinner.playerIdx].bg} rounded-full flex items-center justify-center mx-auto shadow-xl ring-4 ring-white relative z-10 ${gameChampion ? 'champion-shine' : 'animate-bounce'}`}>
                                        <IconGem size={48} color="white" fill="white" />
                                        {gameChampion && <div className="absolute -top-3 -right-3 p-1 rotate-12 scale-150"><IconCrown size={32} /></div>}
                                    </div>
                                    <h2 className="text-3xl font-black text-indigo-950 italic tracking-tighter leading-none mt-2">
                                        {gameChampion ? "CONGRATULATIONS!" : "ROUND WINNER"}
                                    </h2>
                                </div>
                                <div className="glass-card w-full p-4 rounded-xl text-center space-y-2 border-2 shadow-md" style={{ borderColor: PLAYER_CONFIG[selectedWinner.playerIdx].color }}>
                                    <p className="text-[10px] font-black text-slate-400 mb-1">„ÅäÈ°å: {currentOdai}</p>
                                    <p className="text-indigo-600 text-[10px] font-bold italic leading-none">„ÅÇ„ÅÆ„Éº„ÄÅÂ∑Æ„ÅóÊîØ„Åà„Å™„Åë„Çå„Å∞„ÄÅ</p>
                                    <p className="text-lg font-black text-indigo-950 leading-tight italic">„Äå{selectedWinner.card}„Äç</p>
                                </div>
                                {gameChampion ? (
                                    <div className="w-full space-y-3 pt-2 px-4">
                                        <p className="text-center text-sm font-black text-slate-500 mincho underline decoration-gold">üëë {gameChampion.label}„Åï„Çì„ÅåÂ§©‰∏ã„ÇíÁç≤„Çä„Åæ„Åó„Åü</p>
                                        <button onClick={() => setGameState('START')} className="w-full py-4 bg-indigo-600 text-white text-lg font-black rounded-full shadow-2xl active:scale-95 transition-all border-b-4 border-indigo-800">„Çø„Ç§„Éà„É´„Å´Êàª„Çã</button>
                                    </div>
                                ) : (
                                    <div className="w-full space-y-3 pt-2">
                                        <button onClick={() => startRound((oyaIndex + 1) % playerCount)} className="w-full py-4 bg-indigo-950 text-white text-base font-black rounded-full shadow-lg active:scale-95 transition-all">Ê¨°„Å∏ÈÄ≤„ÇÄ</button>
                                        
                                        {/* „Éá„Ç∂„Ç§„É≥„ÇíÂ∑ÆÂà•Âåñ„Åó„Åü‰∏≠Êñ≠„Éú„Çø„É≥ */}
                                        <button 
                                            onClick={() => setGameState('START')} 
                                            className="w-full py-2 border-2 border-slate-200 bg-white/50 text-slate-400 font-bold text-[11px] rounded-full flex items-center justify-center gap-2 active:bg-slate-100 transition-all uppercase tracking-widest"
                                        >
                                            <IconHome /> „Çø„Ç§„Éà„É´„Å´Êàª„Çã
                                        </button>
                                    </div>
                                )}
                            </div>
                        )}
                    </main>

                    {/* „Çπ„Ç≥„Ç¢Ë°®Á§∫Ôºà„Éï„ÉÉ„Çø„ÉºÔºâ */}
                    {gameState !== 'START' && (
                        <footer className="w-full max-w-md pt-1.5 border-t border-indigo-100 overflow-x-auto no-scrollbar pb-3 z-10 fade-in">
                            <div className="flex justify-around gap-1 min-w-full px-1">
                                {PLAYER_CONFIG.slice(0, playerCount).map((cfg, i) => (
                                    <div key={i} className={`flex flex-col items-center gap-0.5 transition-all ${oyaIndex === i && playerCount > 2 ? 'scale-105 opacity-100' : 'opacity-40'}`}>
                                        <div className={`w-7 h-7 rounded-lg flex items-center justify-center border-2 ${oyaIndex === i && playerCount > 2 ? 'bg-indigo-900 border-indigo-400 text-white shadow-sm' : 'bg-white border-slate-100'}`}>
                                            {oyaIndex === i && playerCount > 2 ? <IconStar /> : <IconGem size={12} color={cfg.color} fill={scores[i] > 0 ? cfg.color : "none"} />}
                                        </div>
                                        <div className="flex items-center gap-0.5 bg-white px-1.5 py-0 rounded-full shadow-xs border border-indigo-50/50">
                                            <IconHeart />
                                            <span className="text-[9px] font-black text-indigo-600 leading-none">{scores[i]}</span>
                                            {pointGoal !== '‚àû' && <span className="text-[7px] text-slate-300 font-bold pl-0.5">/{pointGoal}</span>}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </footer>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>